<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.bzz.cloud.gen.dao.GenTableDao">

	<sql id="genTableColumns">
		t.id,
		t.table_name,
		t.comments,
		t.class_name,
		t.table_type,
		t.parent_table,
		t.parent_table_fk,
		t.name_like,
		t.pk_list,
		t.parent_id,
		t.child_list,

		t.create_user,
		t.create_time,
		t.update_user,
		t.update_time,
		t.remarks,
		t.version,
		t.del_flag
	</sql>

	<!--通过id查询-->
	<select id="get" resultType="com.bzz.cloud.gen.entity.GenTable">
		select
			<include refid="genTableColumns"/>
		from gen_table t
		<where>
			t.del_flag = 0 and t.id = #{id}
		</where>
	</select>

	<!--查询-->
	<select id="findList" resultType="com.bzz.cloud.gen.entity.GenTable">
		select
		<include refid="genTableColumns"/>
		from gen_table t
		<where>
			t.del_flag = 0
			<if test="dbType != null and dbType != '' ">
				AND t.table_name LIKE
				<if test="dbType == 'oracle'">'%,'||#{tableName}||',%')</if>
				<if test="dbType == 'mssql'">'%,'+#{tableName}+',%')</if>
				<if test="dbType == 'mysql'">CONCAT('%,', #{tableName}, ',%'))</if>
			</if>
		</where>
	</select>

	<!--插入-->
	<insert id="insert">
		INSERT INTO gen_table(
				id,
				table_name,
				comments,
				class_name,
				table_type,
				parent_table,
				parent_table_fk,
				name_like,
				pk_list,
				parent_id,
				child_list,
				create_user,
				create_time,
				update_user,
				update_time,
				remarks,
				version,
				del_flag
		  ) VALUES (
				#{id},
				#{tableName},
				#{comments},
				#{className},
				#{tableType},
				#{parentTable},
				#{parentTableFk},
				#{nameLike},
				#{pkList},
				#{parentId},
				#{childList},
				#{createUser.id},
				#{createTime},
				#{updateUser.id},
				#{updateTime},
				#{remarks},
				#{version},
				#{delFlag}
				)
	</insert>

	<!-- 更新用户 -->
	<update id="update">
		UPDATE
			gen_table
		SET
			id = #{id},
			table_name = #{tableName} ,
			comments = #{comments},
			class_name = #{className},
			table_type = #{tableType},
			parent_table = #{parentTable},
			parent_table_fk = #{parentTableFk},
			name_like = #{nameLike},
			pk_list = 	#{pkList},
			parent_id = #{parentId},
			child_list = #{childList},
			create_user = #{createUser.id},
			create_time = #{createTime},
			update_user = #{updateUser.id},
			update_time = #{updateTime},
			remarks = #{remarks},
			version = #{version},
			del_flag = #{delFlag}
		WHERE id = #{id}
	</update>

	<!-- 逻辑删除用户 -->
	<update id="deleteFalse">
		UPDATE
			gen_table
		SET
			del_flag = 1
		WHERE
			id = #{id}
	</update>


	<!-- 物理删除用户 -->
	<delete id="delete">
		DELETE FROM gen_table WHERE id = #{id}
	</delete>


</mapper>